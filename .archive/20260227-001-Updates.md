# shruggie-indexer — Pending Updates (2026-02-27, Batch 1)

- **Project:** `shruggie-indexer`
- **Repository:** [shruggietech/shruggie-indexer](https://github.com/shruggietech/shruggie-indexer)
- **Author:** William Thompson (ShruggieTech LLC)
- **Date:** 2026-02-27
- **Target Release:** Pre-v0.1.1 (GUI polish and Settings overhaul)
- **Audience:** AI-first, Human-second
- **Predecessor:** This document follows `20260225-007-Updates.md`. It assumes all items from all prior update documents (`20260223-001` through `20260225-007`) have been implemented and merged.

---

## Purpose

Post-Batch 7, the core indexing pipeline is stable and all behavioral fixes are verified. This batch focuses on GUI visual polish and structural improvements across both the Operations and Settings pages.

The work items fall into three categories:

1. **Operations page refinements.** Visual boundary clarity for anchored regions, collapsible configuration cards, output mode constraint expansion (greying "View only" when Rename is active), button dimension corrections, drag handle affordance, and removal of the forced Log→Output toggle on operation completion.
2. **Settings page overhaul.** Consolidation of six top-level sections into fewer logical groups presented as cards, logging subsection reorganization, log-level dropdown with "None" option and back-end suppression, global action button anchoring, and Advanced Configuration improvements (full default values, field descriptions, individually collapsible subsections).
3. **Documentation site audit.** Identify and catalog all discrepancies between the documentation site's GUI page (`docs/user-guide/gui.md`) and the actual current behavior of the application.

### Implementation Ordering

Items in this document have interdependencies. The following execution order MUST be respected to avoid rework:

1. **Section 1** (Region boundary clarity) — Foundational visual fix affecting both the Operations and Settings pages. Establishes a uniform solution for anchored-region edge visibility that all subsequent layout work must comply with. Execute first.
2. **Section 2** (Operations page: collapsible cards and bottom-region separation) — Structural layout changes to the Operations page. Depends on Section 1 because the boundary clarity solution must be applied to the new collapsible card headers and the bottom anchored region.
3. **Section 3** (Operations page: output mode constraint expansion) — Logic change to `_reconcile_controls()`. Independent of layout changes but should follow Section 2 so the constraint's tooltip can be placed within the finalized card structure.
4. **Section 4** (Operations page: button adjustments) — Dimensional changes to START/STOP buttons and addition of the EXIT button. Depends on Section 2 because the bottom-region layout must be finalized before button sizing is adjusted.
5. **Section 5** (Operations page: remove forced output toggle) — Simple behavioral fix. No layout dependencies; can be implemented any time after Section 2.
6. **Section 6** (Settings page: reorganization) — Major layout overhaul. Depends on Section 1 for the boundary clarity solution. Independent of Operations page changes (Sections 2–5).
7. **Section 7** (Settings page: Advanced Configuration improvements) — Depends on Section 6 because the card layout and section consolidation must be established before the Advanced section is enhanced.
8. **Section 8** (Documentation site audit) — Must be executed last, after all GUI changes from Sections 1–7 are complete, so that the audit reflects the final UI state.
9. **Section 9** (Archive naming convention in spec) — Codifies the `.archive/` file naming convention in the technical specification. Can be executed any time but is grouped here because it feeds into the spec update directive.
10. **Section 10** (Specification update directive) — The final step. Updates the spec to reflect all changes implemented in Sections 1–9.

---

## 1. Region Boundary Clarity (Priority: High — Execute First)

### 1.1. Problem Statement

Several regions of the GUI have boundaries that are visually indistinguishable from their surroundings:

- **Operations page: main "Operations" title.** The bottom edge of the title's anchored region blends into the background of the configuration area below it. When scrolling or resizing, it is unclear where the title region ends and the scrollable content begins.
- **Operations page: bottom anchored region** (START/STOP button area and output/log panel). The top edge of this region is difficult to distinguish from the configuration area above it — especially when the blank space between configuration cards happens to align with the background color of the button area.
- **Settings page: main "Settings" title.** The same boundary clarity issue as the Operations page title — the bottom edge of the heading region is invisible when it aligns with the subsequent section's background.

### 1.2. Design Constraint

The solution MUST be uniform across all occurrences. A single visual treatment must be chosen and applied consistently wherever an anchored (non-scrollable) region borders a scrollable or background-matched content area. Mixing different approaches (e.g., a shadow for the title but a line for the bottom region) would violate §10.9.1 (Layout Stability) and create visual incoherence.

### 1.3. Recommended Approach

Use a subtle **1px separator line** in a muted color (e.g., `gray40` or `gray50` depending on the active theme) at the boundary edge of each anchored region. This is the lightest-weight visual treatment that reliably communicates a region boundary, and it is already used as a convention elsewhere in the application (e.g., the thin separator before the Advanced Configuration section on the Settings page).

The separator should be implemented as a `CTkFrame` with `height=1` and an appropriate `fg_color`. It must be placed at the boundary edge (bottom of title regions, top of the bottom anchored region) and must span the full width of the parent container.

**Alternative approaches considered but not recommended:**

- **Drop shadow / gradient.** CustomTkinter does not natively support CSS-style box shadows. Faking them with layered frames or gradient images adds complexity and fragility for a subtle visual effect.
- **Background color differentiation.** Giving the anchored region a slightly different background color (e.g., `gray14` vs `gray12`) can work but risks looking muddy in certain monitor color profiles and breaks down when the user resizes the window so that card spacing aligns with the color boundary.

The implementing agent should evaluate both approaches and choose the one that looks best in practice, but the separator line is the recommended starting point.

### 1.4. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | Add separator frames at the boundary edges of the Operations page title region, the Operations page bottom anchored region, and the Settings page title region. |

### 1.5. Spec References

| Reference | Section |
|-----------|---------|
| Layout stability | `shruggie-indexer-spec.md` §10.9.1 |
| Window layout | `shruggie-indexer-spec.md` §10.2 |

### 1.6. Acceptance Criteria

- A visible boundary line (or equivalent uniform treatment) is present at the bottom edge of the Operations page title region.
- The same treatment is present at the top edge of the Operations page bottom anchored region (START/STOP + output/log panel).
- The same treatment is present at the bottom edge of the Settings page title region.
- All three boundaries use the identical visual style (color, weight, spacing).
- The boundaries remain visible at all window sizes and do not shift or disappear during scroll or resize operations.
- The solution respects the active color theme (light/dark mode, if applicable).

---

## 2. Operations Page: Collapsible Cards and Bottom-Region Separation (Priority: High)

### 2.1. Problem Statement — Collapsible Cards

The "Target", "Options", and "Output" settings cards on the Operations tab are always fully expanded. For experienced users who have configured their defaults, the fully expanded state wastes vertical space and pushes the action button and output panel further down the viewport. The cards should be collapsible by clicking the card header, allowing users to minimize sections they are not actively configuring.

### 2.2. Research Direction — Collapsible Card UX

Before implementing, the implementing agent MUST research collapsible card patterns in desktop application UIs. Key considerations:

- **Disclosure indicator.** A small chevron or caret icon (▸ collapsed / ▾ expanded) placed at the leading edge of the card header. This is the same pattern already used for the Advanced Configuration section on the Settings page.
- **Animation.** CustomTkinter does not support smooth CSS-style transitions. A clean instant show/hide (pack/pack_forget) is acceptable and already proven in the Advanced Configuration toggle. Do not attempt to implement animated accordion transitions — they add fragility for marginal visual benefit.
- **State persistence.** The expanded/collapsed state of each card should be saved in the session file and restored on application startup. This prevents users from having to re-expand their preferred cards on every launch.
- **Default state.** All three cards should be expanded by default on first launch (no session file present). This preserves the current experience for new users.
- **Accessibility.** The entire card header row (not just the caret) should be clickable. Use `cursor="hand2"` on the header frame and all child widgets within it.

### 2.3. Problem Statement — Drag Handle Affordance

The horizontal bar between the configuration area and the output/log panel is a drag handle for resizing the output panel. Currently, the bar provides no visual indication that it is interactive. Standard UI practice is to include a minimal grip indicator — typically a small cluster of dots (⋮⋮) or two to three short horizontal bars centered on the handle.

### 2.4. Problem Statement — Bottom-Region Visual Separation

The visual separation between the scrollable configuration area and the bottom anchored region (START/STOP button + output/log panel) is insufficient. When the window is sized such that the empty space between configuration cards aligns with the button area's background color, the bottom region is entirely obscured. Users may not realize that additional content exists below the visible configuration cards.

This issue is partially addressed by Section 1 (region boundary clarity), which adds a separator line at the top of the bottom region. However, the drag handle itself should also carry enough visual weight to serve as a secondary separation cue.

### 2.5. Implementation Tasks

**A. Collapsible card headers.** Modify the `_create_labeled_group()` or equivalent card-creation method to add a disclosure caret and click-to-toggle behavior. Apply to the "Target", "Options", and "Output" cards on the Operations page.

**B. Session persistence for card state.** Add collapsed/expanded state for each card to the session file schema. Restore on startup.

**C. Drag handle grip indicator.** Add a centered visual grip to the drag handle bar. A minimal approach is a short row of 2–3 small dots or dashes rendered as a `CTkLabel` with a muted foreground color (e.g., `gray50`). The grip indicator must not interfere with the drag behavior.

**D. Bottom-region separation.** Ensure the separator line from Section 1 is placed above the drag handle, and that the drag handle itself has a slightly differentiated background or border that distinguishes it from blank space. A 1–2px height increase from the current handle, combined with the grip indicator, should be sufficient.

### 2.6. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | Collapsible card headers (Target, Options, Output), drag handle grip indicator, bottom-region separator. Session save/restore for card expanded/collapsed state. |

### 2.7. Spec References

| Reference | Section |
|-----------|---------|
| Target selection and input | `shruggie-indexer-spec.md` §10.3 |
| Output display and export | `shruggie-indexer-spec.md` §10.6 |
| GUI design standards | `shruggie-indexer-spec.md` §10.9 |
| Session persistence | `shruggie-indexer-spec.md` §10.1 |

### 2.8. Acceptance Criteria

- Clicking the header of the "Target", "Options", or "Output" card toggles its expanded/collapsed state.
- A disclosure caret (▸/▾) on the card header reflects the current state.
- The entire card header row is clickable (not just the caret).
- Card expanded/collapsed states persist across application sessions via the session file.
- All three cards are expanded by default on first launch.
- The drag handle displays a centered grip indicator (dots or bars) that communicates interactivity.
- The bottom anchored region is visually distinct from the scrollable configuration area at all window sizes, including edge cases where card spacing aligns with the button area's background.

---

## 3. Operations Page: Output Mode Constraint Expansion (Priority: Medium)

### 3.1. Problem Statement

The current output mode constraint matrix enforces one restriction on "View only":

| Condition | Current behavior |
|-----------|-----------------|
| Operation is Meta Merge Delete | "View only" is removed from the dropdown and falls back to Single file. |

Two additional constraints are missing:

**A. Rename + Index / Meta Merge.** When `Operation Type` is "Index" or "Meta Merge" AND the `Rename files` checkbox is checked, "View only" must not be selectable. Rename requires writing files to disk (the renamed files and their sidecar files); a view-only mode is logically incompatible because the rename operation cannot be previewed without disk I/O.

**B. Meta Merge Delete — visual consistency.** Currently, "View only" is completely removed from the dropdown for Meta Merge Delete. For consistency with constraint (A) above, it should instead remain visible in the dropdown but be greyed out (disabled) with a tooltip explaining the restriction.

### 3.2. Updated Constraint Matrix

The full output mode constraint matrix after this change:

| Condition | View only state | Tooltip text |
|-----------|----------------|--------------|
| Operation is Meta Merge Delete | Greyed out (disabled) | *"View only is not available for Meta Merge Delete. Destructive operations require a persistent output record."* |
| Rename is enabled (any operation) | Greyed out (disabled) | *"View only is not available when Rename is active. Rename requires writing files to disk."* |
| Both conditions apply simultaneously | Greyed out (disabled) | Show the most specific applicable tooltip (Meta Merge Delete takes priority). |
| Neither condition applies | Fully enabled | *(no tooltip)* |

### 3.3. Implementation Notes

CustomTkinter's `CTkOptionMenu` does not natively support per-item disabled states or per-item tooltips. The implementing agent will need to evaluate one of the following approaches:

**Option A: Custom dropdown.** Build a lightweight custom dropdown (e.g., a `CTkFrame` with clickable `CTkLabel` rows) that supports per-item enable/disable and per-item hover tooltips. This provides the richest UX but is the most implementation effort.

**Option B: Post-selection validation.** Keep the standard `CTkOptionMenu` with all three options always listed. When the user selects "View only" while a constraint is active, immediately revert the selection to the previous valid value and display a transient tooltip or info-label message explaining why. This is simpler to implement but provides a less polished experience (the user clicks an option, then it snaps back).

**Option C: Conditional option list with info-label.** Continue to dynamically adjust the option list (as the current code does) but always include "View only" in the list, appending a visual marker (e.g., `"View only ⊘"` or similar) when it is constrained. Show the explanation in the existing `_output_mode_info_label`. This is a compromise between Options A and B.

The implementing agent should choose the approach that produces the cleanest UX within reasonable implementation effort. Option A is preferred if feasible; Option C is an acceptable fallback.

### 3.4. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | Update `_reconcile_controls()` to evaluate the Rename+View only constraint. Modify the output mode dropdown to show disabled items with tooltips instead of removing them. |

### 3.5. Spec References

| Reference | Section |
|-----------|---------|
| Output controls constraint matrix | `shruggie-indexer-spec.md` §10.3 (Output controls) |
| Centralized state reconciliation | `shruggie-indexer-spec.md` §10.3 (`_reconcile_controls()`) |
| Rename and in-place output interaction | `shruggie-indexer-spec.md` §8.4 |

### 3.6. Acceptance Criteria

- When `Operation Type` is "Index" or "Meta Merge" and `Rename files` is checked, "View only" appears in the dropdown but is visually greyed out and not selectable.
- When `Operation Type` is "Meta Merge Delete", "View only" appears in the dropdown but is visually greyed out and not selectable. (This replaces the current behavior of removing it entirely.)
- A tooltip or info-label text explains WHY "View only" is unavailable in each case.
- If "View only" was the active selection and the user enables Rename or switches to Meta Merge Delete, the mode falls back to the appropriate default (Single file for file targets, Multi-file for directory targets).
- When the constraint condition is removed (Rename unchecked, or operation type changed), "View only" becomes fully selectable again.

---

## 4. Operations Page: Button Adjustments (Priority: Medium)

### 4.1. Problem Statement

Three button-related issues need correction:

**A. START button too wide.** The START button currently occupies up to 50% of the window width (or 350px, whichever is smaller), per §10.5. This is disproportionately large relative to the other controls. Reduce the maximum width to approximately 25% of the window width (or 175px, whichever is smaller).

**B. STOP button dimensions mismatch.** When the START button transitions to the "■ Cancel" state during execution, the STOP button should have the exact same dimensions as the (reduced) START button. Currently the two button states may have different widths depending on text length.

**C. EXIT button missing.** There is no application-level exit button in the GUI. An EXIT button should be added to the sidebar, positioned at the bottom left — either directly above or directly below the version number label.

### 4.2. EXIT Button Design

- **Placement:** Bottom of the sidebar, below or above the version label. The exact position should be chosen based on what looks better in practice — the version label acts as a natural "end cap" for the sidebar, so placing EXIT just above it (with a small spacer) is the recommended starting point.
- **Color:** Red or a warm accent color that contrasts with the standard blue/teal button palette. Use `fg_color` appropriate for a cautionary action — not alarming (this is not a destructive data operation), but clearly distinct from navigation buttons.
- **Behavior:** Calls the same `_on_close()` handler (or equivalent) that the window's close button (`WM_DELETE_WINDOW`) triggers. If an indexing operation is in progress, the existing cancellation and cleanup logic should apply.
- **Label:** "Exit" (not "QUIT" or "CLOSE" — "Exit" is the most universally understood desktop application label for this action).

### 4.3. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | Reduce START button max width. Set STOP (Cancel) button to identical dimensions. Add EXIT button to sidebar with close handler. |

### 4.4. Spec References

| Reference | Section |
|-----------|---------|
| Action button behavior | `shruggie-indexer-spec.md` §10.5 |
| Window layout (sidebar) | `shruggie-indexer-spec.md` §10.2 |

### 4.5. Acceptance Criteria

- The START button is approximately half its current width (≈25% of window width or ≈175px max).
- The STOP/Cancel button has the exact same pixel dimensions as the START button.
- An "Exit" button is visible in the sidebar, visually distinct from navigation buttons (red or warm accent color).
- Clicking the Exit button triggers the same close/cleanup sequence as the window's close button.
- If an operation is running when Exit is clicked, the existing cancellation flow executes before the application closes.

---

## 5. Operations Page: Remove Forced Output Toggle on Completion (Priority: Low)

### 5.1. Problem Statement

When the "Log" tab is active in the output/log panel during an indexing operation, the UI force-toggles to the "Output" tab upon operation completion. This overrides the user's explicit choice and is a violation of §10.9.7 (Log/Output Panel Behavior) which should respect user agency.

### 5.2. Required Change

Remove the forced toggle. When an indexing operation completes, the output panel should remain on whichever tab (Output or Log) the user had selected. The user can switch tabs manually if they want to see the output.

### 5.3. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | Remove the post-completion call that forces the output panel to switch to the Output tab. |

### 5.4. Acceptance Criteria

- If the Log tab is active before and during an indexing operation, the Log tab remains active after the operation completes.
- If the Output tab is active before and during an indexing operation, the Output tab remains active after the operation completes.
- The user can freely switch between Output and Log at any time, including during and after operations.

---

## 6. Settings Page: Reorganization (Priority: High)

### 6.1. Problem Statement

The Settings page currently has six top-level sections (Indexing Defaults, Output Preferences, Logging, Interface, Configuration, and Advanced Configurations) arranged as flat labeled groups with thin horizontal separators. This has several problems:

- **Too many top-level sections.** Six sections create a long scrolling page where several sections contain only one or two controls. The cognitive overhead of scanning six headings to find one setting is unnecessarily high.
- **No visual grouping.** The sections use simple separator lines rather than card containers, making it difficult to see where one section ends and another begins — especially when scrolling.
- **Logging control order is illogical.** The "Verbosity" radio buttons appear before the "Write log files" checkbox. Logically, the user decides WHETHER to log before deciding HOW MUCH to log.
- **No log destination display.** Users cannot see where the log file will be written without navigating to the filesystem.
- **Log levels use radio buttons.** Radio buttons for 3+ options consume excessive vertical space and are less compact than a dropdown. Additionally, there is no "None" option for users who want logging completely suppressed.
- **Action buttons are visually attached to the last settings section.** The "Reset to Defaults" and "Open Config Folder" buttons are global application actions but appear to be part of the (adjacent) Configuration section, creating a false logical association.

### 6.2. Section Consolidation

Reduce the six sections to four by merging related groups:

| New section | Absorbs | Controls |
|-------------|---------|----------|
| **Indexing** | Indexing Defaults | Default ID Algorithm, Compute SHA-512 |
| **Output & Logging** | Output Preferences + Logging | JSON Indentation, Log Level (dropdown), Write Log Files (checkbox), Log File Path (read-only display) |
| **Interface** | Interface | Show tooltips on hover |
| **Configuration** | Configuration | Config file path, Browse button |

The Advanced Configuration section remains as a separate collapsible parent below these four sections (addressed in Section 7).

**Rationale for merging Output Preferences + Logging:** JSON indentation is an output formatting preference; log verbosity and log file toggling are output channel preferences. Both control "what the application produces and where it goes." Combining them eliminates a section that would otherwise have a single control (JSON Indentation).

**Rationale for keeping Interface separate despite having one control:** The Interface section is a natural home for future user-facing preference controls (theme selection, font size, language, etc.). Merging it into another section now would require re-splitting it later when those controls are added.

### 6.3. Card Layout

All four top-level sections MUST be presented as card containers — visually bounded regions with a distinct background, consistent with the Operations page's card treatment (§10.3). The cards should:

- Have a slightly raised or differentiated background color from the page background (same treatment as Operations page cards).
- Include a card header with the section title.
- Use consistent padding and spacing matching the Operations page card dimensions.

### 6.4. Logging Subsection Changes

**A. Reorder controls.** Within the "Output & Logging" card, present controls in this order:

1. JSON Indentation (radio buttons or dropdown — retain current widget type).
2. Write log files (checkbox) — moved BEFORE log level.
3. Log Level (dropdown, replacing radio buttons).
4. Log file path (new read-only display).

**B. Log Level dropdown.** Replace the existing `CTkRadioButton` group (Normal / Verbose / Debug) with a `CTkOptionMenu` dropdown containing these options:

| Option | Behavior |
|--------|----------|
| None | Suppress all logging output. No log messages are emitted to the GUI log panel or to the log file. |
| Normal | Standard logging. `INFO`-level and above. |
| Verbose | `DEBUG`-level and above. |
| Debug | Full diagnostic output including trace-level details. |

**C. "None" log level back-end logic.** When "None" is selected:

- The GUI log panel on the Operations page should display a single static notice: *"Logging is disabled. To enable logging, go to Settings → Output & Logging."*
- No log messages should be routed to the log panel during operations.
- If "Write log files" is checked, no log file should be written (the file handler should be suppressed or not attached).
- This logic is GUI-only. The CLI does not need a corresponding "no logging" feature.

**D. Log file path display.** Add a read-only `CTkEntry` (or `CTkLabel` with a bordered frame) below the "Write log files" checkbox that shows the computed log file path. The path should reflect the platform-specific log directory and the current naming convention (per §11.5). The field should be visible regardless of whether "Write log files" is checked, but should show greyed-out/muted text when logging to file is disabled.

### 6.5. Global Action Button Anchoring

The "Reset to Defaults" and "Open Config Folder" buttons must be separated from the settings cards and anchored to a fixed region — either at the top of the page (right-aligned against the "Settings" title) or at the bottom of the page (center-aligned), similar to how the START/STOP button and output panel are anchored on the Operations page.

**Recommended approach:** Anchor the buttons to the **bottom** of the Settings page in a fixed (non-scrollable) region, separated from the scrollable card area by a subtle divider (consistent with the Section 1 boundary clarity solution). This mirrors the Operations page pattern where global actions live in a fixed region below scrollable content.

The fixed region should:

- Contain both buttons side by side, center-aligned.
- Have a subtle separator line at its top edge (same style as Section 1).
- Remain visible at all scroll positions.
- Not scroll with the settings cards.

### 6.6. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | Settings page: replace flat sections with card containers. Merge sections per §6.2. Reorder logging controls. Replace log-level radio buttons with dropdown. Add "None" log level option. Add log file path display. Anchor global buttons to fixed bottom region. Implement "None" log-level suppression in the log panel routing logic. |

### 6.7. Spec References

| Reference | Section |
|-----------|---------|
| Configuration panel | `shruggie-indexer-spec.md` §10.4 |
| Settings layout | `shruggie-indexer-spec.md` §10.4 (settings layout diagram) |
| Settings fields | `shruggie-indexer-spec.md` §10.4 (settings fields table) |
| Logging architecture | `shruggie-indexer-spec.md` §11.1 |
| Log destinations | `shruggie-indexer-spec.md` §11.5 |
| GUI design standards | `shruggie-indexer-spec.md` §10.9 |

### 6.8. Acceptance Criteria

- The Settings page displays four top-level sections (Indexing, Output & Logging, Interface, Configuration) in visually bounded card containers.
- Card styling matches the Operations page card treatment.
- Within "Output & Logging", controls appear in order: JSON Indentation, Write log files, Log Level, Log file path.
- The Log Level control is a dropdown with options: None, Normal, Verbose, Debug.
- Selecting "None" suppresses all logging in the GUI log panel and displays a static disabled-logging notice.
- Selecting "None" with "Write log files" checked does not produce a log file.
- The log file path display shows the computed path and is read-only.
- "Reset to Defaults" and "Open Config Folder" buttons are in a fixed (non-scrollable) region at the bottom of the Settings page, separated from the scrollable card area by a visible divider.
- The global buttons region does not scroll with the settings content.

---

## 7. Settings Page: Advanced Configuration Improvements (Priority: Medium)

### 7.1. Problem Statement

The Advanced Configuration section (added in Batch 3 as a read-only scaffold) currently displays abbreviated representations of the built-in default configuration values. Several improvements are needed before this section is ready for release:

- **Abbreviated values.** The display shows truncated or summarized representations rather than the full actual default values. Users need to see exactly what defaults they would be overriding.
- **No field descriptions.** The subsections within Advanced Configuration show raw configuration values with no explanation of what each field does or when a user might want to change it.
- **No individual collapsibility.** All subsections within Advanced Configuration are either all visible or all hidden (the parent toggle controls everything). Each subsection should be independently collapsible so users can expand only the area they care about.

### 7.2. Required Changes

**A. Full default values.** Every read-only textbox in the Advanced Configuration section must display the complete, untruncated default value from `config/defaults.py`. For list-type values (e.g., `DEFAULT_FILESYSTEM_EXCLUDES`, `DEFAULT_EXIFTOOL_EXCLUDE_KEYS`), all items must be visible — not summarized as "... and 12 more".

**B. Field descriptions.** Each subsection within Advanced Configuration must include a brief description (1–2 sentences) above or within its header area explaining:

- What the configuration group controls.
- When a user might want to change these values.

Descriptions should be rendered as muted-color text below the subsection header, similar to the info-label pattern used elsewhere in the application.

| Subsection | Description |
|------------|-------------|
| Filesystem Exclusions | *"Directories and file patterns that are skipped during traversal. Add entries to prevent indexing of system or build directories."* |
| Metadata Identification | *"Regex patterns used to identify sidecar metadata files. Modify these if your metadata files use non-standard naming conventions."* |
| Metadata Exclusion | *"Regex patterns for files that should be excluded from indexing but are not sidecar files. These are applied before sidecar identification."* |
| ExifTool | *"Arguments passed to ExifTool, keys excluded from metadata output, and file extensions that skip ExifTool processing."* |
| Extension Groups | *"Mappings from file extensions to logical groups (e.g., 'image', 'video'). Used for categorization in output metadata."* |
| Extension Validation | *"Regex pattern defining what constitutes a valid file extension. Files with non-matching extensions are flagged in output."* |

**C. Individually collapsible subsections.** Each subsection within Advanced Configuration must be independently collapsible using the same disclosure-caret pattern established in Section 2 (collapsible cards) and already used for the parent Advanced section.

- Each subsection gets its own ▸/▾ caret and clickable header.
- Clicking a subsection header toggles only that subsection — it does not affect the parent or sibling subsections.
- The parent "Advanced Configuration" toggle controls the visibility of the entire Advanced area. When the parent is collapsed, all subsections are hidden regardless of their individual states. When the parent is expanded, each subsection returns to its last-known individual state.

**D. Default collapsed state.** On first launch (no session file), the parent Advanced Configuration section should be collapsed. Individual subsection states are irrelevant until the parent is expanded. Once the parent has been manually expanded, individual subsection expanded/collapsed states should persist via the session file.

### 7.3. Affected Files

| File | Nature of change |
|------|------------------|
| `src/shruggie_indexer/gui/app.py` | `_build_advanced_groups()`: replace abbreviated displays with full default values, add description labels, convert each subsection to an independently collapsible group. Add subsection states to session persistence. |
| `src/shruggie_indexer/config/defaults.py` | No code changes — read-only source for the displayed values. |

### 7.4. Spec References

| Reference | Section |
|-----------|---------|
| Advanced Configuration scaffold | `shruggie-indexer-spec.md` §10.4 (Advanced Configuration scaffold) |
| Configuration defaults | `shruggie-indexer-spec.md` §7.2 |
| GUI design standards | `shruggie-indexer-spec.md` §10.9 |

### 7.5. Acceptance Criteria

- Every subsection in Advanced Configuration displays the full, untruncated default values from `config/defaults.py`.
- Each subsection includes a brief description (muted text) explaining the configuration group's purpose.
- Each subsection is independently collapsible via a disclosure caret on its header.
- The parent "Advanced Configuration" toggle controls overall visibility. Subsection states are preserved independently.
- Expanded/collapsed states for the parent and all subsections persist across sessions.
- The parent section defaults to collapsed on first launch.

---

## 8. Documentation Site Audit (Priority: Medium — Execute After Sections 1–7)

### 8.1. Purpose

The documentation site's Desktop Application page (`docs/user-guide/gui.md`) was written to describe the GUI as it existed after the Batch 2 implementation cycle. Batches 3–7 introduced behavioral changes and the GUI refinements in Sections 1–7 of this document will introduce further changes. The documentation page must be audited against the actual current state of the application and all discrepancies cataloged.

### 8.2. Required Actions

**A. Audit.** After all GUI changes from Sections 1–7 have been implemented, the implementing agent must:

1. Read the entire `docs/user-guide/gui.md` file.
2. Compare every described behavior, layout element, control, and workflow against the actual running application.
3. Produce a discrepancy table listing every difference.

**B. Catalog format.** The discrepancy table must use this format:

| # | Documentation claim | Actual behavior | Page section | Required action |
|---|--------------------|-----------------|--------------|--------------------|
| 1 | *(what the docs say)* | *(what the app actually does)* | *(which section of gui.md)* | *(add / correct / remove / rewrite)* |

**C. Apply corrections.** After cataloging, apply all corrections to `docs/user-guide/gui.md`. Each correction should be a minimal, targeted edit — do not rewrite the entire page unless the volume of changes makes targeted edits impractical.

**D. Verify build.** After all edits, run `mkdocs build --strict` to confirm zero warnings and no broken internal links.

### 8.3. Known Areas Likely to Have Discrepancies

Based on the changes implemented in this batch, the following documentation sections are likely stale:

| Area | Likely discrepancy |
|------|--------------------|
| Operations tab: output mode | "View only" greying behavior (new constraint for Rename) not documented. Current docs may describe View only as unavailable (removed) for MMD rather than greyed out. |
| Operations tab: card layout | Collapsible cards not documented. |
| Operations tab: button dimensions | START button width described as 50% / 350px; now 25% / 175px. |
| Operations tab: forced toggle | Docs may describe post-completion auto-switch to Output tab. |
| Settings tab: section structure | Docs may list six sections; now four. |
| Settings tab: logging controls | Docs may describe radio buttons; now a dropdown with "None" option. |
| Settings tab: button anchoring | Docs may show buttons as part of the Configuration section; now anchored separately. |
| Settings tab: advanced config | Docs may describe abbreviated values and non-collapsible subsections. |
| Sidebar | EXIT button not documented. |

### 8.4. Affected Files

| File | Nature of change |
|------|------------------|
| `docs/user-guide/gui.md` | Corrections and additions per audit results. |
| `CHANGELOG.md` | Add entries for Batch 1 changes. |
| `docs/changelog.md` | Sync from `CHANGELOG.md`. |

### 8.5. Acceptance Criteria

- A complete discrepancy table has been produced (even if only for internal reference).
- All identified discrepancies in `docs/user-guide/gui.md` have been corrected.
- `mkdocs build --strict` passes with zero warnings.
- No behavioral claims in the documentation contradict the running application.
- `CHANGELOG.md` includes entries for all Batch 1 changes.
- `docs/changelog.md` is synced from `CHANGELOG.md`.

---

## 9. Codify Archive Naming Convention in Technical Specification (Priority: Low)

### 9.1. Problem Statement

The `.archive/` directory's file naming convention was established in `20260225-003-Updates.md` §4.2 and has been followed consistently since then. However, the convention was never codified in the technical specification itself. The spec's §3.1 describes `.archive/` only as *"Human-only workspace for project notes, prompt files, and historical planning artifacts."* — it contains no mention of the naming pattern, the date-scoped increment reset, or the relationship between the increment and the "Batch N" label used in update document titles.

This gap creates a risk: an AI agent working from the spec alone would have no basis for naming new archive files correctly. The convention must be added to the spec so it is self-contained.

### 9.2. Required Spec Changes

Add the following to the `.archive/` entry in the §3.1 layout table (or as a new sub-section immediately following the table), documenting the full naming convention:

**Convention:**

```
<YYYYmmdd>-<ZeroPaddedIncrement>-<title>.<ext>
```

**Field definitions:**

| Component | Description |
|-----------|-------------|
| `YYYYmmdd` | The date the document was created, or for generated artifacts, the date of the source content. |
| `ZeroPaddedIncrement` | A three-digit zero-padded sequence number (`001`, `002`, etc.) for ordering documents created on the same date. **Resets to `001` on each new date.** Related clusters of documents (e.g., an update doc and its prompt template) MAY share the same increment. |
| `title` | A lowercase-hyphenated descriptive title. |
| `ext` | The file extension. |

**Batch label convention:** Update documents use a "Batch N" label in their title header (e.g., *"Pending Updates (2026-02-27, Batch 1)"*). The batch number corresponds to the date-scoped increment: the first update document on a given date is Batch 1 (`001`), the second is Batch 2 (`002`), and so on. The batch number resets to 1 on each new date, matching the increment reset.

### 9.3. Affected Files

| File | Nature of change |
|------|------------------|
| `shruggie-indexer-spec.md` §3.1 | Add archive naming convention documentation to the `.archive/` directory entry or as a dedicated sub-section. |

### 9.4. Acceptance Criteria

- The spec's §3.1 (or a new subsection under §3) documents the full `.archive/` naming convention including the pattern, field definitions, date-scoped increment reset rule, and batch label convention.
- The documentation is sufficient for an AI agent reading only the spec to correctly name new archive files.

---

## 10. Specification Update Directive (Priority: Required — Execute Last)

### 10.1. Purpose

After all work items in Sections 1–9 have been completed, the project technical specification (`shruggie-indexer-spec.md`) must be updated to reflect the changes that were implemented. This is the final step in the batch.

### 10.2. Required Spec Updates

The following spec sections must be reviewed and updated based on the work completed in this document:

| Section affected | Update trigger | Nature of update |
|-----------------|---------------|------------------|
| §10.2 — Window Layout | Section 4.2 (EXIT button) | Add EXIT button to sidebar layout description. Document placement, color, and behavior. |
| §10.3 — Target Selection and Input | Section 2 (collapsible cards) | Document collapsible card behavior for Target, Options, and Output groups. Document session persistence of card states. |
| §10.3 — Output controls | Section 3 (output mode constraint expansion) | Update the constraint matrix to include the Rename + View only restriction. Document the greyed-out-with-tooltip behavior replacing the remove-from-list behavior for Meta Merge Delete. |
| §10.4 — Configuration Panel | Section 6 (Settings reorganization) | Rewrite the settings layout diagram to reflect four sections in card containers. Update the settings fields table. Document log-level dropdown, "None" option, log path display, and global button anchoring. |
| §10.4 — Advanced Configuration scaffold | Section 7 (Advanced config improvements) | Document full default value display, field descriptions, and individually collapsible subsections. |
| §10.5 — Action button behavior | Section 4.1 (button dimensions) | Update the max-width specification from 50%/350px to 25%/175px. Document that STOP dimensions match START. |
| §10.6 — Output Display and Export | Section 2.3 (drag handle) | Document the grip indicator on the drag handle. |
| §10.9.7 — Log/Output Panel Behavior | Section 5 (forced toggle removal) | Remove or correct any language describing forced tab switching on operation completion. |
| §11.1 — Logging Architecture | Section 6.4C ("None" log level) | Document the "None" log level and its GUI-specific suppression behavior. |
| §3.1 — Top-Level Layout | Section 9 (archive naming convention) | Add the `.archive/` file naming convention (`<YYYYmmdd>-<ZZZ>-<title>.<ext>`), including date-scoped increment reset and batch label convention. |

### 10.3. Update Principles

When updating the spec:

1. **Preserve the document's existing style and conventions.** Use the same cross-referencing notation (§ X.Y), deviation codes (DEV-XX), amendment callout format (`> **Updated 2026-02-27:**`), and formatting patterns already established in the spec.
2. **Do not remove historical context.** Deviation notes and comparison-to-original sections should be preserved.
3. **Use amendment callouts** for all changes: `> **Updated 2026-02-27:**` followed by the change description.
4. **Verify cross-references** after all edits. Ensure no `§X.Y` references are broken.

### 10.4. Spec Header Update

Update the spec header:

- **Date:** Change to `2026-02-27`.
- **Status:** Remains `AMENDED`.

### 10.5. Acceptance Criteria

- All spec sections listed in §10.2 have been updated.
- All updates use the `> **Updated 2026-02-27:**` amendment callout convention.
- No cross-references (§X.Y) are broken.
- No spec section describes behavior that contradicts the implemented code.
- The spec's settings layout diagram reflects the four-section card layout.
- The spec's output mode constraint matrix includes the Rename + View only restriction.
- The spec's §3.1 documents the `.archive/` naming convention with date-scoped increment reset and batch label convention.
- The generated `.html` and `.pdf` renderings are regenerated from the updated `.md` source.
